<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <title>My First Multiplayer Game</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="CSS/style.css">

        <script src='/socket.io/socket.io.js'></script>
    </head>

    <body>
        <canvas id="screen" width="10px" height="10px"></canvas>
        <script type="module">
            import createGame from './JS/Game.js';
            import createKeyboardListener from './JS/KeyboardListener.js';
            import renderScreen from './JS/Render.js';

            const game = createGame();

            const keyboardListener = createKeyboardListener(document);
            keyboardListener.subscribe(game.movePlayer);

            const screen = document.getElementById('screen');
            renderScreen(screen, game, requestAnimationFrame);

            const socket = io();
            socket.on('connect', () => {
                const playerID = socket.id;
                console.log(`Player connected on client with id: ${playerID}`);
            });
            socket.on('setup', (state) => {
                game.setState(state);
            });
            socket.on('addPlayer', (command) => {
                console.log(`Receiving ${command.type} -> ${command.playerID}`)
                game.addPlayer(command);
            });
        </script>
    </body>
</html> 